{% load static %}
{% load psat_icon %}

<rateproblem x-data="{ modalOpen: false }">
    {% if user.is_authenticated %}
        <button id="rating{{ problem.id }}" @click="modalOpen = true">{{ icon_rate|safe }}</button>
        <modal class="fixed inset-0 px-2 z-20 overflow-hidden flex items-center justify-center"
             x-show="modalOpen">
            <modaloverlayer class="absolute inset-0 bg-gray-500 bg-opacity-75 transition-opacity"
                 x-cloak x-show="modalOpen"
                 x-transition:enter="transition ease-out duration-300 transform"
                 x-transition:enter-start="opacity-0"
                 x-transition:enter-end="opacity-100"
                 x-transition:leave="transition ease-in duration-200 transform"
                 x-transition:leave-start="opacity-100"
                 x-transition:leave-end="opacity-0"
            ></modaloverlayer>
            <modalcontent class="bg-white rounded-md shadow-xl overflow-hidden max-w-md w-full sm:w-96 md:w-1/2 lg:w-2/3 xl:w-1/3 z-50"
                 x-cloak x-show="modalOpen" @click.away="modalOpen = false"
                 x-transition:enter="transition ease-out duration-300 transform"
                 x-transition:enter-start="opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"
                 x-transition:enter-end="opacity-100 translate-y-0 sm:scale-100"
                 x-transition:leave="transition ease-in duration-200 transform"
                 x-transition:leave-start="opacity-100 translate-y-0 sm:scale-100"
                 x-transition:leave-end="opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"
            >
                <modalheader class="flex items-center justify-center p-4 md:p-5 border-b rounded-t dark:border-gray-600">
                    <h2 class="text-xl font-semibold m-0 text-gray-900 dark:text-white">
                        문제 난이도를 선택해주세요.
                    </h2>
                </modalheader>
                <modalbody class="p-4 text-center text-base">
                    <form class="rate_button"
                          hx-target="#rating{{ problem.id }}" type="button">
                        <fieldset>
                            {% for i in '12345' %}
                                <input type="radio" name="rating" id="rating{{ i }}" value="{{ i|subtract:6 }}"
                                       @click="modalOpen = false"
                                       hx-post="{% url 'psat:rate-problem' problem.id %}">
                                <label for="rating{{ i }}"><i class="fa fa-star cursor-pointer"></i></label>
                            {% endfor %}
                        </fieldset>
                    </form>
                </modalbody>
            </modalcontent>
        </modal>
    {% else %}
        <a href="{% url 'account_login' %}">
            {{ icon_rate|safe }}
        </a>
    {% endif %}
</rateproblem>
